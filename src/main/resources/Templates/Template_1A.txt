# TEMPLATE 1A (VERSÃO FINAL - ADAPTADA PARA ESTRUTURA REAL DO GRAFO)
SELECT ?ANS WHERE {
    # 1. Encontra o nó que tem o TICKER como seu RDFS:LABEL.
    #    Isso contorna a falta da propriedade b3:ticker.
    ?S1 rdfs:label "#ENTIDADE_NOME#" .

    # 2. A partir deste nó, encontra um dos muitos nós de negociação.
    ?S1 P3 ?SO2 .  # ?S1 b3:negociado ?negociadoEmPregao .

    # 3. Filtra para encontrar a negociação na data correta.
    ?SO2 P5 ?S2 .  # ?negociadoEmPregao b3:negociadoDurante ?pregao .
    ?S2 P6 "#DATA#"^^xsd:date .
    
    # 4. A partir do nó de negociação correto, pega o valor desejado.
    ?SO2 #VALOR_DESEJADO# ?ANS .
}
LIMIT 1