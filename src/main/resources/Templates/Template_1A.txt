# TEMPLATE 1A (VERSÃO SIMPLES E DIRETA)
SELECT ?ANS WHERE {
    # 1. Encontra o nó do Valor Mobiliário (a ação) pelo ticker.
    #    Nós não vamos mais procurar pelo nome da empresa para evitar ambiguidade.
    ?S1 P8 "#ENTIDADE_NOME#" .  # ?valorMobiliario b3:ticker "CMIN3" .

    # 2. A partir do Valor Mobiliário, encontra o nó da negociação daquele dia.
    ?S1 P3 ?SO2 . # ?valorMobiliario b3:negociado ?negociadoEmPregao .

    # 3. Filtra para encontrar a negociação na data correta.
    ?SO2 P5 ?S2 . # ?negociadoEmPregao b3:negociadoDurante ?pregao .
    ?S2 P6 "#DATA#"^^xsd:date . # ?pregao b3:ocorreEmData "data" .
    
    # 4. A partir do nó de negociação correto, pega o valor desejado.
    ?SO2 #VALOR_DESEJADO# ?ANS .
}
LIMIT 1